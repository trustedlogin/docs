"use strict";(self.webpackChunktrustedlogin_docs=self.webpackChunktrustedlogin_docs||[]).push([[325],{9759:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var s=i(4848),t=i(8453);const l={},o="Working with Vault",r={id:"SaaS/vault",title:"Working with Vault",description:"An instance of HashiCorp Vault is used to store all sensitive data about customer sites.",source:"@site/docs/SaaS/vault.md",sourceDirName:"SaaS",slug:"/SaaS/vault",permalink:"/SaaS/vault",draft:!1,unlisted:!1,editUrl:"https://github.com/trustedlogin/docs/edit/main/docs/SaaS/vault.md",tags:[],version:"current",frontMatter:{},sidebar:"SaaS",previous:{title:"The Vault SaaS Token",permalink:"/SaaS/vault-sass-token"},next:{title:"Webhooks",permalink:"/SaaS/webhooks"}},a={},c=[{value:"Check TTL Of Auth Token",id:"check-ttl-of-auth-token",level:2},{value:"Renew Auth Token",id:"renew-auth-token",level:2},{value:"Request That A Key Store Be Created For Vendor",id:"request-that-a-key-store-be-created-for-vendor",level:2},{value:"Request Short-Term Token For Client Plugin To Create Site With",id:"request-short-term-token-for-client-plugin-to-create-site-with",level:2},{value:"Request Access Logs For A Site",id:"request-access-logs-for-a-site",level:2},{value:"Request That A Site Be Removed Form Vault",id:"request-that-a-site-be-removed-form-vault",level:2},{value:"Request Short-Term Token For Support-side Plugin To Read Site data",id:"request-short-term-token-for-support-side-plugin-to-read-site-data",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"working-with-vault",children:"Working with Vault"}),"\n",(0,s.jsxs)(n.p,{children:["An instance of ",(0,s.jsx)(n.a,{href:"https://www.vaultproject.io",children:"HashiCorp Vault"})," is used to store all sensitive data about customer sites."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The URL of Vault is: ",(0,s.jsx)(n.code,{children:"https://vault.trustedlogin.com"})]}),"\n",(0,s.jsxs)(n.li,{children:['The "app\'s auth token" Refers to the token used to identify this app, with Vault.',"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"This token should grant the ability to take these actions and no others."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:['The "SaaS Token" is ',(0,s.jsx)(n.a,{href:"/SaaS/vault-sass-token",children:"documented here"})]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"check-ttl-of-auth-token",children:"Check TTL Of Auth Token"}),"\n",(0,s.jsx)(n.p,{children:"To check the TTL of the current token used by the app to authenticate against vault:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/auth/token/index.html#lookup-a-token-self-",children:"API Docs"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/auth/token/lookup-self"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"GET"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'X-Vault-Token':<token>"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Request Body: None"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Example Response:"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "request_id": "ac4a1ed6-64f7-6cca-2f38-182efdf37e4a",\n    "lease_id": "",\n    "renewable": false,\n    "lease_duration": 0,\n    "data": {\n        "accessor": "X9H1u4IrPFgbUmjhToXtH5mq",\n        "creation_time": 1557336326,\n        "creation_ttl": 0,\n        "display_name": "root",\n        "entity_id": "",\n        "expire_time": null,\n        "explicit_max_ttl": 0,\n        "id": "s.KODayxpVxBLBw8MxZdRKTU7r",\n        "meta": null,\n        "num_uses": 0,\n        "orphan": true,\n        "path": "auth/token/root",\n        "policies": [\n            "root"\n        ],\n        "ttl": 0,\n        "type": "service"\n    },\n    "wrap_info": null,\n    "warnings": null,\n    "auth": null\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"renew-auth-token",children:"Renew Auth Token"}),"\n",(0,s.jsx)(n.p,{children:"To renew the app's auth token for longer use:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/auth/token/index.html#renew-a-token-self-",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/auth/token/renew-self"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"POST"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "increment": "42h" \n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "request_id": "e113b883-0241-e8f0-39a9-b1fded129c63",\n    "lease_id": "",\n    "renewable": false,\n    "lease_duration": 0,\n    "data": null,\n    "wrap_info": null,\n    "warnings": null,\n    "auth": {\n        "client_token": "s.XWBIrPzWxZaobgtZRwwV0der",\n        "accessor": "DSHxCZA9fWVjtKIBmNhEsQ1x",\n        "policies": [\n            "default",\n            "saas-policy"\n        ],\n        "token_policies": [\n            "default",\n            "saas-policy"\n        ],\n        "metadata": null,\n        "lease_duration": 151200,\n        "renewable": true,\n        "entity_id": "",\n        "token_type": "service",\n        "orphan": false\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"request-that-a-key-store-be-created-for-vendor",children:"Request That A Key Store Be Created For Vendor"}),"\n",(0,s.jsx)(n.p,{children:"Vault can have a specific database or key store per vendor. When a vendor signs up, a new key store is created."}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsxs)(n.p,{children:["The Key Store will be called ",(0,s.jsx)(n.code,{children:"<namespace>-store"})," where ",(0,s.jsx)(n.code,{children:"<namespace>"})," is a variable identifying the Client's project. (eg Key Store name = ",(0,s.jsx)(n.code,{children:"gravityview-store"})," for ",(0,s.jsx)(n.code,{children:"GravityView"})," project.). It is in the URI."]})]}),"\n",(0,s.jsx)(n.p,{children:"To request a new key store for a vendor:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/system/mounts.html#enable-secrets-engine",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/sys/mounts/<namespace>-store"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"POST"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "type": "kv",\n    "description":"Key Store for client X",\n    "options": {\n        "version": "1"\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response: 204 - No Content"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Once this is received, create policies for Client Plugin Token and Delete Site permissions:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Policy will be called ",(0,s.jsx)(n.code,{children:"<namespace>-write-policy"})," where ",(0,s.jsx)(n.code,{children:"<namespace>"})," is a variable identifying the Client's project. (eg Policy name = ",(0,s.jsx)(n.code,{children:"gravityview-write-policy"})," for ",(0,s.jsx)(n.code,{children:"GravityView"})," project.). This is in the URI."]}),"\n",(0,s.jsxs)(n.li,{children:["The Key Store name from before ",(0,s.jsx)(n.code,{children:"<namespace>-store"})," is used in the Request Body."]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/system/policies.html#create-update-acl-policy",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/sys/policies/acl/<namespace>-write-policy"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"PUT"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"policy": "path \\"<namespace>-store/*\\" { capabilities = [\\"create\\", \\"update\\", \\"delete\\"]}"\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response: 204 - No Content"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"and:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Policy will be called ",(0,s.jsx)(n.code,{children:"<namespace>-delete-policy"})," where ",(0,s.jsx)(n.code,{children:"<namespace>"})," is a variable identifying the Client's project. (eg Policy name = ",(0,s.jsx)(n.code,{children:"gravityview-delete-policy"})," for ",(0,s.jsx)(n.code,{children:"GravityView"})," project.). This is in the URI."]}),"\n",(0,s.jsx)(n.li,{children:"This policy is used to create a token that extends SaaS privileges to be able to remove Sites from Key Store."}),"\n",(0,s.jsxs)(n.li,{children:["The Key Store name from before ",(0,s.jsx)(n.code,{children:"<namespace>-store"})," is used in the Request Body."]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/system/policies.html#create-update-acl-policy",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/sys/policies/acl/<namespace>-delete-policy"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"PUT"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"policy": "path \\"<namespace>-store/*\\" { capabilities = [\\"delete\\"]}"\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response: 204 - No Content"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"and:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Policy will be called ",(0,s.jsx)(n.code,{children:"<namespace>-read-policy"})," where ",(0,s.jsx)(n.code,{children:"<namespace>"})," is a variable identifying the Client's project. (eg Policy name = ",(0,s.jsx)(n.code,{children:"gravityview-read-policy"})," for ",(0,s.jsx)(n.code,{children:"GravityView"})," project.). This is in the URI."]}),"\n",(0,s.jsxs)(n.li,{children:["This policy is used to create a token for Support-side plugin to read secrets from ONLY ",(0,s.jsx)(n.code,{children:"<namesspace>-store"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The Key Store name from before ",(0,s.jsx)(n.code,{children:"<namespace>-store"})," is used in the Request Body."]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/system/policies.html#create-update-acl-policy",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/sys/policies/acl/<namespace>-read-policy"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"PUT"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"policy": "path \\"<namespace>-store/*\\" { capabilities = [\\"read\\"]}"\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response: 204 - No Content"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"request-short-term-token-for-client-plugin-to-create-site-with",children:"Request Short-Term Token For Client Plugin To Create Site With"}),"\n",(0,s.jsxs)(n.p,{children:["The client plugin will make requests to this app's ",(0,s.jsx)(n.code,{children:"POST /api/site"})," endpoint to request a token it can use to create site in Vault."]}),"\n",(0,s.jsx)(n.p,{children:"To get that token from Vault:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"<namespace>-write-policy"})," in Request Body was defined above and tells the token what it can/can't access"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/auth/token/index.html#create-token",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/auth/token/create"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"POST"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t  "policies": [\n\t    "<namespace>-write-policy"\n\t  ],\n\t  "metadata": {\n\t    "key": "value",\n\t  },\n\t  "ttl": "7d",\n\t  "renewable": true,\n\t  "display_name": "Write Token",\n\t}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "request_id": "...", // string\n    "wrap_info": null,\n    "warnings": null,\n    "auth": {\n        "client_token": "...", // string\n        "accessor": "...", // string\n        "policies": [\n            "default",\n            "gravityview-write-policy" // the policy defining permissions\n        ],\n        "token_policies": [\n            "default",\n            "gravityview-write-policy" // the policy defining permissions\n        ],\n        "metadata": null,\n        "lease_duration": 1296000,\n        "renewable": true,\n        "entity_id": "",\n        "token_type": "service",\n        "orphan": false\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"request-access-logs-for-a-site",children:"Request Access Logs For A Site"}),"\n",(0,s.jsx)(n.p,{children:"To get access logs for a specific site, app can make a this request to Vault:"}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"This documentation is incomplete. We are working on it."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/..."})]}),"\n",(0,s.jsx)(n.li,{children:"HTTP Method - ..."}),"\n",(0,s.jsx)(n.li,{children:"Required Headers ..."}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "hi": "roy"\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "hi": "roy"\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"request-that-a-site-be-removed-form-vault",children:"Request That A Site Be Removed Form Vault"}),"\n",(0,s.jsx)(n.p,{children:"If the app needs to remove record of a site login, it can make this request to Vault:"}),"\n",(0,s.jsx)(n.p,{children:"First need to create a temporary token with delete permissions. Then use this Token to give SaaS the ability to delete Site info."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"<token>"})," (the SaaS token) is used in Headers. ",(0,s.jsx)(n.code,{children:"<namespace>-delete-policy"})," in Request Body was defined above and tells the token what it can/can't access"]})}),"\n",(0,s.jsx)(n.p,{children:"To get that token from Vault:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/auth/token/index.html#create-token",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/auth/token/create"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"POST"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t  "policies": [\n\t    "<namespace>-delete-policy"\n\t  ],\n\t  "ttl": "1d",\n\t  "renewable": false,\n\t  "display_name": "Delete Token",\n\t}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "request_id": "...",\n    "wrap_info": null,\n    "warnings": null,\n    "auth": {\n        "client_token": "<deleteToken>",\n        "accessor": "...",\n        "policies": [\n            "default",\n            "gravityview-delete-policy"\n        ],\n        "token_policies": [\n            "default",\n            "gravityview-delete-policy"\n        ],\n        "metadata": null,\n        "lease_duration": 1296000,\n        "renewable": true,\n        "entity_id": "",\n        "token_type": "service",\n        "orphan": false\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Then use that generated token to delete the secret:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<deleteToken>"})," (from above) is used in Headers instead of ",(0,s.jsx)(n.code,{children:"<token>"}),".\n2: ",(0,s.jsx)(n.code,{children:"<secret-id>"})," is provided from Client-side plugin in the request body sent to SaaS via ",(0,s.jsx)(n.code,{children:"POST /sites"})]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/secret/kv/kv-v1.html#delete-secret",children:"API Docs"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/<namespace>-store/<secret-id>"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"DELETE"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'X-Vault-Token': <deleteToken>"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Request Body: None"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Example Response: 204 - No Content"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"request-short-term-token-for-support-side-plugin-to-read-site-data",children:"Request Short-Term Token For Support-side Plugin To Read Site data"}),"\n",(0,s.jsx)(n.p,{children:"The support-side plugin will make requests to the SaaS app to get a token it can use to read sites in Vault."}),"\n",(0,s.jsx)(n.p,{children:"To get that token from Vault:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"<namespace>-read-policy"})," in Request Body was defined above and tells the token what it can/can't access"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/api/auth/token/index.html#create-token",children:"API Docs"})}),"\n",(0,s.jsxs)(n.li,{children:["URI - ",(0,s.jsx)(n.code,{children:"/v1/auth/token/create"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP Method - ",(0,s.jsx)(n.code,{children:"POST"})]}),"\n",(0,s.jsxs)(n.li,{children:["Required Headers ",(0,s.jsx)(n.code,{children:"'Content-Type':'application/json','X-Vault-Token':<token>"})]}),"\n",(0,s.jsx)(n.li,{children:"Request Body:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t  "policies": [\n\t    "<namespace>-read-policy"\n\t  ],\n\t  "ttl": "24h",\n\t  "renewable": true,\n\t  "display_name": "Support-side Token",\n\t}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example Response:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "request_id": "...", // string\n    "wrap_info": null,\n    "warnings": null,\n    "auth": {\n        "client_token": "...", // string\n        "accessor": "...", // string\n        "policies": [\n            "default",\n            "gravityview-write-policy" // the policy defining permissions\n        ],\n        "token_policies": [\n            "default",\n            "gravityview-write-policy" // the policy defining permissions\n        ],\n        "metadata": null,\n        "lease_duration": 1296000,\n        "renewable": true,\n        "entity_id": "",\n        "token_type": "service",\n        "orphan": false\n    }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var s=i(6540);const t={},l=s.createContext(t);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);