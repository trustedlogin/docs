"use strict";(globalThis.webpackChunktrustedlogin_docs=globalThis.webpackChunktrustedlogin_docs||[]).push([[884],{1867(e,t,i){i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"security","title":"Security","description":"For Client SDK security, see Client SDK.","source":"@site/docs/security.md","sourceDirName":".","slug":"/security","permalink":"/security","draft":false,"unlisted":false,"editUrl":"https://github.com/trustedlogin/docs/edit/main/docs/security.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Security","sidebar":"auto","sidebar_position":2},"sidebar":"Home","previous":{"title":"Getting Started","permalink":"/"},"next":{"title":"Login Flow Diagrams","permalink":"/flows"}}');var r=i(4848),s=i(8453);const a={title:"Security",sidebar:"auto",sidebar_position:2},o="Security",c={},d=[{value:"Encryption",id:"encryption",level:2},{value:"Encrypted-at-rest data storage",id:"encrypted-at-rest-data-storage",level:2},{value:"SaaS application security",id:"saas-application-security",level:2},{value:"IP restrictions",id:"ip-restrictions",level:3},{value:"Strong-password policy",id:"strong-password-policy",level:3},{value:"2FA",id:"2fa",level:3},{value:"Cleanup",id:"cleanup",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"security",children:"Security"})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["For Client SDK security, see ",(0,r.jsx)(t.a,{href:"/Client/security",children:"Client SDK"}),"."]})}),"\n",(0,r.jsx)(t.h2,{id:"encryption",children:"Encryption"}),"\n",(0,r.jsx)(t.p,{children:"The ID of the user who granted access to the website, the URL of the website where access is being granted as well as vendor-defined array of metadata are stored unencrypted."}),"\n",(0,r.jsxs)(t.p,{children:["Login credentials are encrypted using Sodium ",(0,r.jsx)(t.a,{href:"https://libsodium.gitbook.io/doc/public-key_cryptography/sealed_boxes",children:"sealed boxes"})," using keys generated using on the Vendor website."]}),"\n",(0,r.jsxs)(t.p,{children:["Because cryptobox encryption cannot verify the identity of the sender, during decryption requests, the clients send additional headers (",(0,r.jsx)(t.code,{children:"X-TL-TOKEN"}),") with each request. The ",(0,r.jsx)(t.code,{children:"X-TL-TOKEN"})," hash includes private keys only known to the Vendor and SaaS. Those private keys, if compromised, can be cycled SaaS-side."]}),"\n",(0,r.jsx)(t.h2,{id:"encrypted-at-rest-data-storage",children:"Encrypted-at-rest data storage"}),"\n",(0,r.jsxs)(t.p,{children:["Secrets are encrypted and stored using the ",(0,r.jsx)(t.a,{href:"https://libsodium.gitbook.io/doc/public-key_cryptography/sealed_boxes",children:"Sodium Secret Box"})," algorithm in the Hashicorp Vault."]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["For more information around data storage, see ",(0,r.jsx)(t.a,{href:"/SaaS/data-storage",children:"SaaS Data Storage"}),"."]})}),"\n",(0,r.jsx)(t.h2,{id:"saas-application-security",children:"SaaS application security"}),"\n",(0,r.jsx)(t.h3,{id:"ip-restrictions",children:"IP restrictions"}),"\n",(0,r.jsxs)(t.p,{children:["The SaaS Vault, Elasticsearch, and Kibana are protected behind IP restrictions using Traefik. ",(0,r.jsx)(t.a,{href:"/SaaS/server-setup#traefik",children:"See how Traefik is used"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"strong-password-policy",children:"Strong-password policy"}),"\n",(0,r.jsxs)(t.p,{children:["The TrustedLogin application has a minimum password length of 12 characters. Passwords are required to meet ",(0,r.jsx)(t.a,{href:"https://github.com/dropbox/zxcvbn",children:"zxcvbn level 4"}),': "very unguessable: strong protection from offline slow-hash scenario."']}),"\n",(0,r.jsx)(t.h3,{id:"2fa",children:"2FA"}),"\n",(0,r.jsx)(t.p,{children:"The application requires two-factor authentication (2FA) to create an account and 2FA is required on every login."}),"\n",(0,r.jsx)(t.h2,{id:"cleanup",children:"Cleanup"}),"\n",(0,r.jsx)(t.p,{children:"When accounts are deleted, the secrets associated with the team are deleted from the Vault."}),"\n",(0,r.jsxs)(t.p,{children:["Deleting a team triggers the ",(0,r.jsx)(t.code,{children:"Laravel\\Spark\\Events\\Teams\\TeamDeleted"})," event."]}),"\n",(0,r.jsxs)(t.p,{children:["The following listeners are triggered by the ",(0,r.jsx)(t.code,{children:"Laravel\\Spark\\Events\\Teams\\TeamDeleted"})," event:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"\\App\\Listeners\\RemoveTeamFromVault"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"\\App\\Listeners\\DeleteTeamElasticSearchData"})}),"\n"]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"Team-specific data is removed from Elasticsearch, but non-identifiable usage data is kept for administrative reporting purposes."})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,t,i){i.d(t,{R:()=>a,x:()=>o});var n=i(6540);const r={},s=n.createContext(r);function a(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);