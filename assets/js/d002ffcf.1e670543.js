"use strict";(globalThis.webpackChunktrustedlogin_docs=globalThis.webpackChunktrustedlogin_docs||[]).push([[878],{6960(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"SaaS/vault-client","title":"Vault API Client","description":"The Vault API client is used to make HTTP requests to the Vault instance.","source":"@site/docs/SaaS/vault-client.md","sourceDirName":"SaaS","slug":"/SaaS/vault-client","permalink":"/SaaS/vault-client","draft":false,"unlisted":false,"editUrl":"https://github.com/trustedlogin/docs/edit/main/docs/SaaS/vault-client.md","tags":[],"version":"current","frontMatter":{},"sidebar":"SaaS","previous":{"title":"Remote User Authentication","permalink":"/SaaS/user-remote-authentication"},"next":{"title":"The Vault SaaS Token","permalink":"/SaaS/vault-sass-token"}}');var i=n(4848),a=n(8453);const o={},r="Vault API Client",c={},l=[{value:"Team Key Store",id:"team-key-store",level:2},{value:"Creation of the Keystore",id:"creation-of-the-keystore",level:3},{value:"Creation Of The Keystore Policies",id:"creation-of-the-keystore-policies",level:3},{value:"The Keystore Tokens",id:"the-keystore-tokens",level:3},{value:"Access Team Tokens",id:"access-team-tokens",level:4}];function h(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"vault-api-client",children:"Vault API Client"})}),"\n",(0,i.jsx)(t.p,{children:"The Vault API client is used to make HTTP requests to the Vault instance."}),"\n",(0,i.jsx)(t.h2,{id:"team-key-store",children:"Team Key Store"}),"\n",(0,i.jsx)(t.h3,{id:"creation-of-the-keystore",children:"Creation of the Keystore"}),"\n",(0,i.jsxs)(t.p,{children:["When an account is created, Spark's ",(0,i.jsx)(t.code,{children:"TeamCreated"})," event fires. A keystore is created in Vault with the slug column from the team model used as the namespace in Vault."]}),"\n",(0,i.jsx)(t.h3,{id:"creation-of-the-keystore-policies",children:"Creation Of The Keystore Policies"}),"\n",(0,i.jsx)(t.p,{children:"Then three policies are created for the at key store."}),"\n",(0,i.jsxs)(t.p,{children:['The first, "The Write Policy" is created with create, read and delete capabilities. The policy name is ',(0,i.jsx)(t.code,{children:"<namespace>-write-policy"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:['A second policy "The Delete Policy" is created with the capability of delete.  The policy name is ',(0,i.jsx)(t.code,{children:"<namespace>-delete-policy"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:['A third policy, which completes the trilogy, "The Read Token" is created with the read capability. The policy name is ',(0,i.jsx)(t.code,{children:"<namespace>-read-policy"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"the-keystore-tokens",children:"The Keystore Tokens"}),"\n",(0,i.jsx)(t.p,{children:"This also schedules a job to update the team's tokens. This job will repeat once a day."}),"\n",(0,i.jsx)(t.p,{children:'The job that updates the team\'s tokens is concerned with three tokens. The first token, "The Write Token" uses the write policy. The second token, "The Delete Token" uses the delete policy. The third token, "The Read Token" used the read policy.'}),"\n",(0,i.jsx)(t.h4,{id:"access-team-tokens",children:"Access Team Tokens"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"PHP"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"use \\App\\Team;\n$team = Team::find(42);\n$deleteToken = $team->deleteToken();\n$writeToken = $team->writeToken();\n"})})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453(e,t,n){n.d(t,{R:()=>o,x:()=>r});var s=n(6540);const i={},a=s.createContext(i);function o(e){const t=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);