"use strict";(self.webpackChunktrustedlogin_docs=self.webpackChunktrustedlogin_docs||[]).push([[679],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return m}});var i=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=i.createContext({}),p=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=p(e.components);return i.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},c=i.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),c=p(t),m=o,g=c["".concat(s,".").concat(m)]||c[m]||u[m]||r;return t?i.createElement(g,l(l({ref:n},d),{},{components:t})):i.createElement(g,l({ref:n},d))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=c;var a={};for(var s in n)hasOwnProperty.call(n,s)&&(a[s]=n[s]);a.originalType=e,a.mdxType="string"==typeof e?e:o,l[1]=a;for(var p=2;p<r;p++)l[p]=t[p];return i.createElement.apply(null,l)}return i.createElement.apply(null,t)}c.displayName="MDXCreateElement"},1283:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return a},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return d},default:function(){return c}});var i=t(7462),o=t(3366),r=(t(7294),t(3905)),l=["components"],a={},s="TrustedLogin SDK",p={unversionedId:"Client/intro",id:"Client/intro",isDocsHomePage:!1,title:"TrustedLogin SDK",description:"Easily and securely log in to your customers sites when providing support.",source:"@site/docs/Client/intro.md",sourceDirName:"Client",slug:"/Client/intro",permalink:"/docs/Client/intro",editUrl:"https://github.com/trustedlogin/docs/edit/main/website/docs/Client/intro.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hooks",permalink:"/docs/Client/hooks"},next:{title:"TrustedLogin Vendor Plugin",permalink:"/docs/Vendor/README"}},d=[{value:"Our priority: SDKs should not crash sites",id:"our-priority-sdks-should-not-crash-sites",children:[],level:2},{value:"Including in your plugin or theme",id:"including-in-your-plugin-or-theme",children:[{value:"1. The best way: Use Composer and Strauss",id:"1-the-best-way-use-composer-and-strauss",children:[],level:3},{value:"No-Conflict mode",id:"no-conflict-mode",children:[],level:3},{value:"When testing on local environments",id:"when-testing-on-local-environments",children:[],level:3}],level:2},{value:"Security details",id:"security-details",children:[{value:"Logging in",id:"logging-in",children:[],level:3},{value:"Lockdown mode",id:"lockdown-mode",children:[{value:"Preventing sites from going into lockdown:",id:"preventing-sites-from-going-into-lockdown",children:[],level:4}],level:3},{value:"Disabling TrustedLogin",id:"disabling-trustedlogin",children:[],level:3}],level:2},{value:"Reference IDs",id:"reference-ids",children:[],level:2},{value:"Logging",id:"logging",children:[{value:"Using your own logging library",id:"using-your-own-logging-library",children:[],level:3}],level:2},{value:"FAQ",id:"faq",children:[{value:"WordPress.org compliance",id:"wordpressorg-compliance",children:[],level:3},{value:"If my <code>vendor/namespace</code> isn&#39;t unique, what happens?",id:"if-my-vendornamespace-isnt-unique-what-happens",children:[],level:3}],level:2}],u={toc:d};function c(e){var n=e.components,t=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"trustedlogin-sdk"},"TrustedLogin SDK"),(0,r.kt)("p",null,"Easily and securely log in to your customers sites when providing support."),(0,r.kt)("h2",{id:"our-priority-sdks-should-not-crash-sites"},"Our priority: ",(0,r.kt)("a",{parentName:"h2",href:"https://www.bugsnag.com/blog/sdks-should-not-crash-apps"},"SDKs should not crash sites")),(0,r.kt)("p",null,"When you integrate TrustedLogin into your project (theme, plugin, or custom code), you are counting on us not to mess up your customer or clients' sites. We take that extremely seriously."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"including-in-your-plugin-or-theme"},"Including in your plugin or theme"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("h3",{parentName:"div",id:"when-you-see-\ufe0f-make-sure-to-replace-with-your-own-names"},"When you see \u26a0\ufe0f, make sure to replace with your own names!"),(0,r.kt)("p",{parentName:"div"},'In the examples below, we\'re going to pretend your plugin or theme is named "Pro Block Builder" and your business is named Widgets, Co. These should not be the names you use\u2014make sure to update the sample code below to match your business and plugin/theme name!'))),(0,r.kt)("h3",{id:"1-the-best-way-use-composer-and-strauss"},"1. The best way: Use Composer and Strauss"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If you don't have a ",(0,r.kt)("inlineCode",{parentName:"li"},"composer.json")," file for your plugin or theme:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Copy the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/trustedlogin/trustedlogin-example/blob/master/composer.json"},"Sample Plugin's composer.json file")),(0,r.kt)("li",{parentName:"ul"},"Replace ",(0,r.kt)("inlineCode",{parentName:"li"},"name")," with your business and your plugin's name (needs to be all lowercase). For example: ",(0,r.kt)("inlineCode",{parentName:"li"},'name: "widgets-co/pro-block-builder"'),"."),(0,r.kt)("li",{parentName:"ul"},"If you have a theme, replace ",(0,r.kt)("inlineCode",{parentName:"li"},'"type": "wordpress-plugin",')," with ",(0,r.kt)("inlineCode",{parentName:"li"},'"type": "wordpress-theme",')))),(0,r.kt)("li",{parentName:"ul"},"If you have a ",(0,r.kt)("inlineCode",{parentName:"li"},"composer.json file")," for your plugin or theme, add/merge the ",(0,r.kt)("inlineCode",{parentName:"li"},"repositories"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"require"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"require-dev"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"autoload"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"extra"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"scripts")," rules from the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/trustedlogin/trustedlogin-example/blob/master/composer.json"},"Sample Plugin's composer.json file")),(0,r.kt)("li",{parentName:"ul"},"In the ",(0,r.kt)("inlineCode",{parentName:"li"},"composer.json")," file, in the ",(0,r.kt)("inlineCode",{parentName:"li"},"dep_namespace"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"dep_directory"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"classmap_directory"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"classmap_prefix"),' settings, replace each "ReplaceMe" with your own namespace, like ',(0,r.kt)("inlineCode",{parentName:"li"},"ProBlockBuilder"),". For example, ",(0,r.kt)("inlineCode",{parentName:"li"},'"dep_namespace": "\\\\ReplaceMe\\\\",')," will become ",(0,r.kt)("inlineCode",{parentName:"li"},'"dep_namespace": "\\\\ProBlockBuilder\\\\",')," \u26a0\ufe0f"),(0,r.kt)("li",{parentName:"ul"},"Using a command-line application (Terminal on the Mac, Windows Terminal on Windows): Change directories into your plugin or theme's folder ",(0,r.kt)("inlineCode",{parentName:"li"},"cd /path/to/wp/wp-content/plugins/pro-block-builder/")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"cd /path/to/wp/wp-content/themes/pro-block-builder/")," \u26a0\ufe0f"),(0,r.kt)("li",{parentName:"ul"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"composer install"),'. If you see "command not found: composer", you will need to install Composer. ',(0,r.kt)("a",{parentName:"li",href:"https://getcomposer.org/doc/00-intro.md"},"Here's how to install Composer"),"."),(0,r.kt)("li",{parentName:"ul"},"In your plugin or theme, instantiate a new object using your namespace (",(0,r.kt)("inlineCode",{parentName:"li"},"ProBlockBuilder"),") \u26a0\ufe0f:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"// Check class_exists() for sites running PHP 5.2.x\nif ( class_exists( '\\ProBlockBuilder\\TrustedLogin\\Client') ) {\n    new \\ProBlockBuilder\\TrustedLogin\\Client( $config ); // \u26a0\ufe0f\n}\n")),(0,r.kt)("h3",{id:"no-conflict-mode"},"No-Conflict mode"),(0,r.kt)("p",null,"Some plugins like Gravity Forms and GravityView have a \"no-conflict mode\" to limit script and style conflicts. If you see\nscripts and styles not loading on your Grant Support Access page, that's what's going on."),(0,r.kt)("p",null,"The WordPress script and style handles registered by TrustedLogin are formatted as ",(0,r.kt)("inlineCode",{parentName:"p"},"trustedlogin-{namespace}"),".\nHere's an example of how GravityView (with a namespace of ",(0,r.kt)("inlineCode",{parentName:"p"},"gravityview"),") allows TrustedLogin scripts:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"add_filter( 'gravityview_noconflict_scripts', function ( $allowed_scripts = array() ) {\n\n    $allowed_scripts[] = 'trustedlogin-gravityview'; // GravityView's namespace is `gravityview`\n\n    return $allowed_scripts;\n} );\n")),(0,r.kt)("h3",{id:"when-testing-on-local-environments"},"When testing on local environments"),(0,r.kt)("p",null,"TrustedLogin won't work in local environments unless using a tunnel such as ngrok. Thus, TrustedLogin will display a warning when attempting to generate a login when in a local environment."),(0,r.kt)("p",null,"To disable the warning, define ",(0,r.kt)("inlineCode",{parentName:"p"},"TRUSTEDLOGIN_DISABLE_LOCAL_NOTICE")," and set it to true:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"define( 'TRUSTEDLOGIN_DISABLE_LOCAL_NOTICE', true );\n")),(0,r.kt)("h2",{id:"security-details"},"Security details"),(0,r.kt)("h3",{id:"logging-in"},"Logging in"),(0,r.kt)("p",null,"Every time a login occurs using a TrustedLogin link, the login is also verified by the TrustedLogin service."),(0,r.kt)("p",null,"In the future, the TrustedLogin service will analyze the usage patterns of access keys to ensure security."),(0,r.kt)("h3",{id:"lockdown-mode"},"Lockdown mode"),(0,r.kt)("p",null,"TrustedLogin should not generate incorrect access keys. If incorrect access keys are used to attempt a login, it may be the sign of a brute force attack on your plugin."),(0,r.kt)("p",null,"When TrustedLogin identifies more than 3 incorrect logins in 10 minutes, TrustedLogin enables lockdown mode for the plugin for 20 minutes."),(0,r.kt)("p",null,"Lockdown mode:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Prevents all site access using the plugin's TrustedLogin link"),(0,r.kt)("li",{parentName:"ul"},"Notifies the TrustedLogin service of the lockdown"),(0,r.kt)("li",{parentName:"ul"},"Runs the ",(0,r.kt)("inlineCode",{parentName:"li"},"trustedlogin/{namespace}/lockdown/after")," action so developers can customize behavior")),(0,r.kt)("h4",{id:"preventing-sites-from-going-into-lockdown"},"Preventing sites from going into lockdown:"),(0,r.kt)("p",null,"When setting up TrustedLogin on a testing site, it may be helpful to temporarily disable lockdown mode."),(0,r.kt)("p",null,"Security checks will automatically be disabled for ",(0,r.kt)("inlineCode",{parentName:"p"},"local")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"development")," sites based on the value of the ",(0,r.kt)("a",{parentName:"p",href:"https://developer.wordpress.org/reference/functions/wp_get_environment_type/"},(0,r.kt)("inlineCode",{parentName:"a"},"wp_get_environment_type()"))," function."),(0,r.kt)("p",null,"You can also define a ",(0,r.kt)("inlineCode",{parentName:"p"},"TRUSTEDLOGIN_TESTING_{NAMESPACE}")," constant in the site's ",(0,r.kt)("inlineCode",{parentName:"p"},"wp-config.php")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"define( 'TRUSTEDLOGIN_TESTING_EXAMPLE', true );\n")),(0,r.kt)("h3",{id:"disabling-trustedlogin"},"Disabling TrustedLogin"),(0,r.kt)("p",null,"To disable TrustedLogin, define a ",(0,r.kt)("inlineCode",{parentName:"p"},"TRUSTEDLOGIN_DISABLE")," constant in the site's ",(0,r.kt)("inlineCode",{parentName:"p"},"wp-config.php")," file. That will prevent all code that uses TrustedLogin from loading TrustedLogin."),(0,r.kt)("p",null,"To prevent a single TrustedLogin installation, you will need to know the namespace. Once you have the namespace,  define a ",(0,r.kt)("inlineCode",{parentName:"p"},"TRUSTEDLOGIN_DISABLE_{NAMESPACE}")," constant in the site's ",(0,r.kt)("inlineCode",{parentName:"p"},"wp-config.php")," file. The namespace must be in all caps."),(0,r.kt)("h2",{id:"reference-ids"},"Reference IDs"),(0,r.kt)("p",null,"Reference IDs are useful when you want to attach a specific ticket ID or conversation ID to a login."),(0,r.kt)("p",null,"Reference IDs can be passed via URL like so: ",(0,r.kt)("inlineCode",{parentName:"p"},"wp-login.php?action=trustedlogin&ns={namespace}&ref=[123]")),(0,r.kt)("p",null,"When a Reference ID exists, users will see the reference while granting access:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://d.pr/2bVGbj+",alt:"Reference ID is shown below the footer links in the Grant Access screen"})),(0,r.kt)("h2",{id:"logging"},"Logging"),(0,r.kt)("p",null,"We recommend disabling logging by default, but sometimes logs are necessary."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"TrustedLogin creates a ",(0,r.kt)("inlineCode",{parentName:"li"},"trustedlogin-logs")," directory inside the ",(0,r.kt)("inlineCode",{parentName:"li"},"wp-content/uploads/")," directory."),(0,r.kt)("li",{parentName:"ol"},"An empty ",(0,r.kt)("inlineCode",{parentName:"li"},"index.html")," file is placed inside the directory to prevent browsing."),(0,r.kt)("li",{parentName:"ol"},"New log files are created daily for each TrustedLogin namespace. The default log ",(0,r.kt)("inlineCode",{parentName:"li"},"filename")," format is ",(0,r.kt)("inlineCode",{parentName:"li"},"trustedlogin-debug-{date}-{hash}"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{date}")," is ",(0,r.kt)("inlineCode",{parentName:"li"},"YYYY-MM-DD")," format"),(0,r.kt)("li",{parentName:"ul"},"The hash is generated using ",(0,r.kt)("inlineCode",{parentName:"li"},"wp_hash()")," using on the ",(0,r.kt)("inlineCode",{parentName:"li"},"vendor/namespace"),", site ",(0,r.kt)("inlineCode",{parentName:"li"},"home_url()"),", and the day of the year (",(0,r.kt)("inlineCode",{parentName:"li"},"date('z')"),"). The point of the hash is to make log names harder to guess (security by obscurity).")))),(0,r.kt)("h3",{id:"using-your-own-logging-library"},"Using your own logging library"),(0,r.kt)("p",null,"If you add an action for ",(0,r.kt)("inlineCode",{parentName:"p"},"trustedlogin/{namespace}/logging/log"),", TrustedLogin will let you handle logging. See hook description below."),(0,r.kt)("h2",{id:"faq"},"FAQ"),(0,r.kt)("h3",{id:"wordpressorg-compliance"},"WordPress.org compliance"),(0,r.kt)("p",null,"TrustedLogin requires user action to provide logins. This is in compliance with WordPress.org."),(0,r.kt)("p",null,"All files (vendor logo, CSS, and JS files) must be local (using ",(0,r.kt)("inlineCode",{parentName:"p"},"plugin_dir_url()")," or similar) to comply with WordPress.org rules."),(0,r.kt)("h3",{id:"if-my-vendornamespace-isnt-unique-what-happens"},"If my ",(0,r.kt)("inlineCode",{parentName:"h3"},"vendor/namespace")," isn't unique, what happens?"),(0,r.kt)("p",null,"There will be an issue generating the login screen, but it will cause no security problems. The namespace is not used in\nencryption or when generating the requests to your website."))}c.isMDXComponent=!0}}]);